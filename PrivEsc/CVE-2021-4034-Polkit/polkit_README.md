Polkit (formerly PolicyKit) is a component for controlling system-wide privileges in Unix-like operating systems. It provides an organized way for non-privileged processes to communicate with privileged processes. It is also possible to use polkit to execute commands with elevated privileges using the command pkexec followed by the command intended to be executed (with root permission).

Basically, I have provided all the files from the exploit located in berdav's repo for polkit: https://github.com/berdav/CVE-2021-4034

His exploit uses the name of the cve as many of the file names and when you have a simple web shell on a machine it's easier to type polkit than cve-2021-4034, so I just modified some names basically.

To build the exploit yourself, you first need to get the "build_yourself" folder onto the target machine. Then you would change into this directory and run "make" as root to build the exploit. You can also use "sudo make" in the directory, but either way you need to have root permissions on the box on which you make the exploit. If you know the architecture of the system you've compromised, you could also make the exploit on a system similar to the target, on which you have the proper permissions.

However you build it, you will notice a new file in the directory called "polkit" that is executable. Running this is as simple as typing "./polkit", and you should get a shell back immediately if the target is vulnerable. Note: you must have all contents of the build_yourself directory AND the polkit executable file on the target system for the exploit to work. Which brings me to my next point.

Making things simpler, I already built the exploit on my Kali 2021.4 system and zipped it up. The file polkit.zip may be all you need. If you can get this file onto the target and unzip it, everything that's necessary for the exploit to work is included.

To unzip the file:
unzip polkit.zip

Then change into the new polkit folder on your target and run ./polkit

If this doesn't work, the system either is not vulnerable to the exploit or the architecture doesn't match up properly. 

If the architecture is incorrect, you can just place the polkit.zip file on a system with the right architecture, unzip it, change into the polkit directory, remove the polkit file, run sudo make to recreate the polkit file with the right architecture, and then try running the exploit again.

If this doesn't work, then feel free to play with the files to try to exploit the system, but know your target may have been updated/patched.
